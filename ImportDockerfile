FROM farao/farao-computation-base:1.9.0 as BUILDER
ARG JAR_FILE=cse-cc-import-runner-app/target/*-exec.jar
COPY ${JAR_FILE} app.jar
RUN mkdir -p /tmp/app  \
    && java -Djarmode=tools  \
    -jar /app.jar extract --layers --launcher \
    --destination /tmp/app

FROM farao/farao-computation-base:1.9.0
COPY --from=BUILDER /tmp/app/dependencies/ ./
COPY --from=BUILDER /tmp/app/application/ ./
COPY --from=BUILDER /tmp/app/snapshot-dependencies/ ./
ENTRYPOINT ["java", "-cp", "BOOT-INF/lib/*:BOOT-INF/classes", "com.farao_community.farao.cse.import_runner.app.CseApplication"]